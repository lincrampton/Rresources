*** CLUSTER
---
Read in flower data (flower.csv) and change datatype to matrix to vector.  Note that it would not be a good idea to go directly from csv to vector, because would lose nice square matrix structure
```{r}
flower = read.csv("./Data/flower.csv", header=FALSE)
str(flower)
flowerMatrix = as.matrix(flower)
str(flowerMatrix)
flowerVector = as.vector(flowerMatrix)
str(flowerVector)

#NOT GOOD  flowerVector2 = as.vector(flower); str(flowerVector2)
```
Compute a hierarchical (euclidean) distance matrix.
Look at what happens when select 3 clusters.
```{r}
distance = dist(flowerVector, method = "euclidean")
clusterIntensity = hclust(distance, method="ward.D")
plot(clusterIntensity)

rect.hclust(clusterIntensity, k = 3, border = "red")
flowerClusters = cutree(clusterIntensity, k = 3)
flowerClusters
```
Find the mean intensity value for each cluster
```{r}
tapply(flowerVector, flowerClusters, mean)
```
First convert flowerClusters vector to matrix using dim.
Check out how image was segmented using image function.
```{r}
dim(flowerClusters) = c(50,50)
image(flowerClusters, axes = FALSE)
#image(flowerMatrix,axes=FALSE,col=grey(seq(0,1,length=256))) # Original image
```
Read in an MRI datafile and transform into a matrix into a vector
```{r}
healthy = read.csv("Data/healthy.csv", header=FALSE)
healthyMatrix = as.matrix(healthy)
str(healthyMatrix)
image(healthyMatrix,axes=FALSE,col=grey(seq(0,1,length=256)))
healthyVector = as.vector(healthyMatrix)
```
Can you compute the distance matrix using hierarchical clustering? Kmeans with a maximum 1000 iterations?
```{r}
#distance = dist(healthyVector, method = "euclidean") # 2 big
str(healthyVector)
k = 5
set.seed(1)
KMC = kmeans(healthyVector, centers = k, iter.max = 1000)
str(KMC)
```
Make a variable healthyClusters with kmeans cluster info. Convert healthyClusters to a matrix.  Make sure it is the same size as healthyMatrix.
```{r}
healthyClusters = KMC$cluster
KMC$centers[2]
dim(healthyClusters) = c(nrow(healthyMatrix), ncol(healthyMatrix))
image(healthyClusters, axes = FALSE, col=rainbow(k))
``
Use this MRI image to identify sick clusters.  Read in tumor dataset. Treat healthyVector as a training set.
```{r}
tumor = read.csv("./Data/tumor.csv", header=FALSE)
tumorMatrix = as.matrix(tumor)
tumorVector = as.vector(tumorMatrix)

install.packages("flexclust")
library('flexclust')

KMC.kcca = as.kcca(KMC, healthyVector)

tumorClusters = predict(KMC.kcca, newdata = tumorVector)
dim(tumorClusters) = c(nrow(tumorMatrix), ncol(tumorMatrix))

image(tumorClusters, axes = F, col=rainbow(k))
```
